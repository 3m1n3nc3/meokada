<script src="https://checkout.stripe.com/checkout.js"></script>
<script src="https://js.paystack.co/v1/inline.js"></script>
<div class="explore-page-container">
	<div class="sub__header go_pro_sub_header">
		<div class="container">
			<div class="col-md-8">
				<h4 class="animated fadeInUpBig">{{LANG upgrade_to_pro}}</h4>
			</div>
			<div class="col-md-4 pp_exp_head_svg text-center hidden-xs hidden-sm">
				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="feather feather-compass" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
			</div>
		</div>
		<svg class="go_pro_wave" viewBox="0 0 100 15"><path fill="#fff" opacity="0.5" d="M0 30 V15 Q30 3 60 15 V30z"></path><path fill="#fff" d="M0 30 V12 Q30 17 55 12 T100 11 V30z"></path></svg>
	</div>
	
	<div class="container">
		<div class="explore-people-container">
			<h2 class="text-center">{{LANG join_pro}}</h2>
			<h4 class="text-center">{{LANG enjoy_more_features}}</h4> 
			<div class="row people"> 
        		<?php if ($config['standard_system'] === 'off' || $me['is_standard']):?>
				<div class="col-md-2"></div>
        		<?php endif;?>
				<div class="col-md-4">
					<div class="text-center go_pro_plan free_plan">
						<b><?php echo $context['currency_symbol']; ?>0</b>
						<h3>{{LANG free_member}}</h3>
						<hr>
						<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#f44336" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"></path></svg> {{LANG featured_member}}</p>
						<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#f44336" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"></path></svg> {{LANG verified_badge}}</p>
						<?php if ($config['boosted_posts'] > 0) { ?>
							<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#f44336" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"></path></svg> {{LANG posts_promote_up}} 0 <?php if ($config['boosted_posts'] > 1) { ?>{{LANG posts}}<?php }else{ ?>{{LANG post}}<?php } ?></p>
						<?php } ?>
						<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#f44336" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"></path></svg> {{LANG profile_Style}}</p>
						<div class="button_go_pro">
							<button onclick="location.href='{{CONFIG site_url}}';"><span>{{LANG stay_free}}</span></button>
						</div>
					</div>
				</div>
                <?php if ($config['pro_system'] === 'on' && !$me['is_pro']):?>
				<div class="col-md-4">
					<div class="text-center go_pro_plan pro_plan">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M15.2,10.7L16.6,16L12,12.2L7.4,16L8.8,10.8L4.6,7.3L10,7L12,2L14,7L19.4,7.3L15.2,10.7M14,19.1H13V16L12,15L11,16V19.1H10A2,2 0 0,0 8,21.1V22.1H16V21.1A2,2 0 0,0 14,19.1Z" /></svg>
						<b><?php echo $context['currency_symbol'].number_format($config['pro_price'], 2); ?></b>
						<h3>{{LANG pro_member}}</h3>
<!-- 						<small>{{LANG per_month}}</small> -->
						<hr>
						<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> {{LANG featured_member}}</p>
						<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> {{LANG verified_badge}}</p>
						<?php if ($config['boosted_posts'] > 0) { ?>
							<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> {{LANG posts_promote_up}} {{CONFIG boosted_posts}} <?php if ($config['boosted_posts'] > 1) { ?>{{LANG posts}}<?php }else{ ?>{{LANG post}}<?php } ?></p>
						<?php } ?>
						<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> {{LANG profile_Style}}</p>
						<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> {{LANG partake_paid_challenge}}</p>
						<div class="button_go_pro button_go_pro_upgrade">
							<button onclick="Pxp_GetPaymentMethods('pro');"><span>{{LANG upgrade}}</span></button>
						</div>
					</div>
				</div>
                <?php endif;?>
        		<?php if ($config['standard_system'] === 'on' && !$me['is_standard']):?>
				<div class="col-md-4">
					<div class="text-center go_pro_plan pro_plan"> 
						<b><?php echo $context['currency_symbol'].number_format($config['standard_price'], 2); ?></b>
						<h3>{{LANG standard_member}}</h3>
<!-- 						<small>{{LANG per_month}}</small> -->
						<hr>
						<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> {{LANG featured_member}}</p> 
						<?php if ($config['standard_boosted_posts'] > 0) { ?>
							<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> {{LANG posts_promote_up}} {{CONFIG standard_boosted_posts}} <?php if ($config['standard_boosted_posts'] > 1) { ?>{{LANG posts}}<?php }else{ ?>{{LANG post}}<?php } ?></p>
						<?php } ?>
						<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> {{LANG profile_Style}}</p>
						<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> {{LANG partake_paid_challenge}}</p>
						<div class="button_go_pro button_go_pro_upgrade">
							<button onclick="Pxp_GetPaymentMethods('standard');"><span>{{LANG upgrade}}</span></button>
						</div>
					</div>
				</div> 
        		<?php else:?>
				<div class="col-md-2"></div>
        		<?php endif;?>
				<div class="clearfix"></div>
			</div>
		</div>
	</div>
    
    <?php if ($config['community_system'] != 'off'): ?>
    <div class="container">
        <div class="explore-people-container">
            <h2 class="text-center">{{LANG join_community}}</h2>
            <h4 class="text-center">{{LANG community_is_everything}}</h4> 
            <div class="row people"> 
            <?php $community = $context['adminer']->listCommunityPlans(); $i = 0;
                if (!empty($community)) { ?>
                    <?php foreach ($community as $key => $cplan) { $i++; ?> 

                    <div class="col-md-4">
                        <div class="text-center go_pro_plan pro_plan"> 
                            <b><?php echo $context['currency_symbol'].number_format($cplan['price'], 2); ?></b>
                            <h3><?php echo $cplan['title']; ?></h3>
<!--                             <small>{{LANG per_month}}</small> -->
                            <hr>
                            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> {{LANG pro_member}}</p>
                            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#4CAF50" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg> <?php echo $cplan['description']; ?></p>
                            <div class="button_go_pro button_go_pro_upgrade">
                                <button onclick="Pxp_GetPaymentMethods({'community':'<?php echo $cplan['id']; ?>'});"><span>{{LANG upgrade}}</span></button>
                            </div>
                        </div>
                    </div> 
                    <?php } ?>
            <?php } ?>
            </div>
        </div>
    </div>  
    <?php endif;?>  
</div>

<div class="confirm--modal go_pro--modal" style="display: none !important;">
	<div class="confirm--modal--inner">
		<div class="confirm--modal--body">
			<h5>{{LANG choose_method}}</h5>
			<div class="payment_methods_modal">
			</div>
		</div>
		<div class="confirm--modal--footer">
			<button class="btn btn-default" data-confirm--modal-dismiss>{{LANG cancel}}</button>
		</div>
	</div>
</div>

<div class="confirm--modal bank_payment--modal" style="display: none !important;">
	<div class="confirm--modal--inner">
		<div class="confirm--modal--body dt_bank_trans_modal">
			<h5>{{LANG bank_transfer}}</h5>
			<div class="bank_alert"></div>
			<?php echo $config['bank_description'];?>
			<br>
			<br>
			<?php if (!empty($config['bank_transfer_note'])) { ?>
			<div class="dt_user_profile">
				<ul class="dt_prof_vrfy">
					<li><?php echo $config['bank_transfer_note'];?></li>
				</ul>
			</div>
			<?php } ?>
			<div class="fak_image">
				<div id="fake_img_holder"></div>
				<div class="upload_fk_image" onclick="document.getElementById('upload-image').click(); return false">
					<div class="upload_fk_image_content">
						<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="currentColor" d="M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z" /></svg> {{LANG upload_file}}
					</div>
				</div>
			</div>
		</div>
		<div class="confirm--modal--footer">
			<button class="btn btn-default" data-confirm--modal-dismiss>{{LANG cancel}}</button>
			<button class="btn btn-danger btn-red send_bank">{{LANG send}}</button>
			<form class="bank_transfer_form">
	      		<input class="hidden" id="upload-image" type="file" name="image" multiple accept="image/*">
	      		<input class="hidden" type="text" name="type" value="pro">
                <input class="hidden" type="text" name="price" value="">
	      		<input type="reset" id="configreset" value="Reset" class="hidden">
	      	</form>
		</div>
	</div>
</div>


<script type="text/javascript">
    $(document).ready(function() {
    	$("#upload-image").on('change', function() {
    	//Get count of selected files
    	var product_countFiles = $(this)[0].files.length;
    	var product_imgPath = $(this)[0].value;
    	var extn = product_imgPath.substring(product_imgPath.lastIndexOf('.') + 1).toLowerCase();
    	var product_image_holder = $("#fake_img_holder");
    	product_image_holder.empty();
    	if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
    		if (typeof(FileReader) != "undefined") {
    		//loop for each file selected for uploaded.
    		for (var i = 0; i < product_countFiles; i++) 
    		{
    			var product_reader = new FileReader();
    			product_reader.onload = function(e) {
    				$("<img />", {
                        "src": e.target.result,
                        "class": "thumb-image"
                      }).appendTo(product_image_holder);
                    }
                    product_image_holder.show();
                    product_reader.readAsDataURL($(this)[0].files[i]);
                  }
                } else {
                  product_image_holder.html("<p>This browser does not support FileReader.</p>");
                }
             }
    	});
    });

	$(document).on('click', '.send_bank', function(event) {
		$(".bank_transfer_form").submit();
	});

	$(".bank_transfer_form").ajaxForm({
		type:'POST',
		dataType:'json',
		url: link('go_pro/bank_transfer'),
		success:function(data){
			if (data.status == 200) {
				$('.bank_alert').html($('<div>',{
                    class:'alert alert-success',
                    text:data.message
                }));
                setTimeout(function(){
	                window.location.href = site_url('');
	            },3000);
			}
			else{
				$('.bank_alert').html($('<div>',{
                    class:'alert alert-danger',
                    text:data.message
                }));

			}
			setTimeout(function(){
                $('.alert-danger').slideUp('fast',function(){
                    $(this).remove(); 
                })    
                 $('.alert-success').slideUp('fast',function(){
                    $(this).remove(); 
                }) 
            },2000);
		}
	});

	function Pxp_GetPaymentMethods(type) {
		$('.button_go_pro_upgrade').find('button').attr('disabled','true');
		$('.button_go_pro_upgrade').find('button').find('span').html("{{LANG please_wait}}");
		$.post(link('main/get_payment_methods'), {type: type}, function(data, textStatus, xhr) {
			if (data.status == 200) {
				$('.payment_methods_modal').html(data.html);
				$('.go_pro--modal').fadeIn(250);
			}
			$('.button_go_pro_upgrade').find('button').removeAttr('disabled');
			$('.button_go_pro_upgrade').find('button').find('span').html("{{LANG upgrade}}");
		});
	}

	function Pxp_GetPayPalLink(type) {
		$('.btn-paypal').attr('disabled','true');
		$.post(link('go_pro/get_paypal_link'), {type: type}, function(data, textStatus, xhr) {
			if (data.status == 200) {
				window.location.href = data.url;
			}
			$('.btn-paypal').removeAttr('disabled');
		});
	}

	function Pxp_BankPayment(type, price) {
		var click_event = "$('#upload-image').trigger('click');";
		$(".images-renderer").html('<div class="select-images" onclick="'+click_event+'"><span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-image"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg><h5>{{LANG choose_an_image}}</h5></span></div>');
		$('#configreset').click();
		$('.bank_payment--modal').fadeIn(250);
        var type = (typeof type === 'object' && type !== null) ? JSON.stringify(type) : type;
        $('.bank_transfer_form').find('input[name=type]').attr('value', type);
        $('.bank_transfer_form').find('input[name=price]').attr('value', price);
	}

	function Pxp_StripePayment(type,amount=0) {
		$('.btn-cart').attr('disabled','true');
        var typen = (typeof type === 'object' && type !== null) ? Object.keys(type)[0]+ ' ' +type[Object.keys(type)[0]] : type;
		var handler = StripeCheckout.configure({
	        key: "<?php echo $config['stripe_id'];?>",
	        locale: 'english',
	        image: '',
	        token: function(token) {
	          $('.confirm--modal--body').html('<i class="fa fa-spin fa-spinner"></i> {{LANG c_payment}}');
	          $.post(link('go_pro/stripe_payment'), {stripeToken:token.id,type:type,amount:amount}, function (data) {
	          	 if (data.status == 200) {
	          	 	window.location.href = data.url;
	          	 } else {
	          	 	$('.confirm--modal--body').html('<i class="fa fa-spin fa-spinner"></i> {{LANG payment_declined}}');
	          	 }
	          });
	        }
	    });

	    handler.open({
           name: "<?php echo $config['site_name']?>",
           description: "Upgrade to "+typen,
           amount: amount,
           currency: '<?php echo $config['currency']?>',
           opened: function () {
           	   $('.btn-cart').removeAttr('disabled');
           	   $('.go_pro--modal').fadeOut(250);
           }
        });

	    $(window).on('popstate', function() {
	       handler.close();
	    });
	}

	function Pxp_PaystackPayment(type, amount=0) {
		$('.btn-cart').attr('disabled','true'); 

        var handler = PaystackPop.setup({
            key: "<?php echo $config['paystack_public'] ?>", // Replace with your public key
            email: "<?php echo $me['email'] ?>",
            currency: "<?php echo $config['currency'] ?>",
            amount: amount*100,
            firstname: "<?php echo ($me['fname'] ? $me['fname'] : $me['username']) ?>",
            lastname: "<?php echo $me['lname'] ?>",
            // label: "Optional string that replaces customer email"
            onClose: function(){
           	    $('.btn-cart').removeAttr('disabled');
           	    $('.go_pro--modal').fadeOut(250);
            },
            callback: function(response){
	           $('.confirm--modal--body').html('<i class="fa fa-spin fa-spinner"></i> {{LANG c_payment}}');
	           $.post(link('go_pro/paystack_payment'), {reference:response.reference,type:type,amount:amount}, function (data) {
	          	    if (data.status == 200) {
	          	 	    window.location.href = data.url;
	          	    } else {
	          	 	    $('.confirm--modal--body').html('<i class="fa fa-spin fa-spinner"></i> {{LANG payment_declined}}');
	          	    }
	           }); 
            }
        });
          
        handler.openIframe(); 
	}
</script>
